<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HymnLok 140-Question Edition</title>
    <style>
        :root { --math: #3b82f6; --ela: #a855f7; --sci: #10b981; --soc: #e74c3c; }
        body { font-family: 'Inter', sans-serif; background: #0f172a; color: #f1f5f9; display: flex; justify-content: center; padding: 20px; }
        #app { background: #1e293b; width: 100%; max-width: 600px; padding: 40px; border-radius: 24px; border: 1px solid #334155; }
        .hidden { display: none !important; }
        .visual-box { background: #0f172a; border: 1px solid #334155; border-radius: 16px; padding: 25px; margin: 20px 0; text-align: center; font-size: 60px; }
        .btn { display: block; width: 100%; padding: 18px; margin: 10px 0; border: 1px solid #334155; border-radius: 12px; cursor: pointer; background: #1e293b; text-align: left; font-size: 16px; color: #cbd5e1; transition: 0.2s; }
        .btn:hover { background: #334155; border-color: #3b82f6; color: #fff; }
        .sub-btn { color: white; border: none; text-align: center; font-size: 18px; font-weight: 700; }
        #progress-bar { height: 10px; background: #0f172a; border-radius: 10px; margin-bottom: 20px; overflow: hidden; }
        #progress-fill { height: 100%; width: 0%; transition: 0.4s; }
        .grade-tag { font-size: 12px; padding: 5px 15px; background: #3b82f6; border-radius: 8px; color: #fff; font-weight: 800; }
        .dot { width: 10px; height: 10px; background: #334155; border-radius: 50%; }
        .dot.active { background: #10b981; box-shadow: 0 0 10px #10b981; }
    </style>
</head>
<body>

<div id="app">
    <div id="home">
        <h1 style="text-align:center; font-size: 50px; font-weight: 800;">HymnLok</h1>
        <p style="text-align:center; color: #94a3b8; margin-bottom: 30px;">35-Item Reserve Pool (30 Question Session)</p>
        <button class="btn sub-btn" style="background:var(--math)" onclick="run('math')">üìê Mathematics</button>
        <button class="btn sub-btn" style="background:var(--ela)" onclick="run('ela')">üìñ Language Arts</button>
        <button class="btn sub-btn" style="background:var(--sci)" onclick="run('science')">üß¨ Science</button>
        <button class="btn sub-btn" style="background:var(--soc)" onclick="run('social')">üåç Social Studies</button>
    </div>

    <div id="quiz" class="hidden">
        <div style="display:flex; justify-content:space-between; align-items: center; margin-bottom:10px;">
            <span id="q-count" style="color:#64748b; font-size: 14px; font-weight: bold;">ITEM 1 / 30</span>
            <span id="grade-level" class="grade-tag">GRADE 6</span>
        </div>
        <div style="display:flex; gap:8px; margin-bottom:10px;"><div class="dot" id="d1"></div><div class="dot" id="d2"></div><div class="dot" id="d3"></div></div>
        <div id="progress-bar"><div id="progress-fill"></div></div>
        <div id="visual-area" class="visual-box"></div>
        <h2 id="q-text" style="font-weight: 500; font-size: 1.2rem;"></h2>
        <div id="options"></div>
    </div>

    <div id="results" class="hidden">
        <h1 style="text-align:center;">Results</h1>
        <div id="final-rit" style="text-align:center; font-size: 80px; font-weight: 900; color: #3b82f6;"></div>
        <p id="accuracy" style="text-align:center; color:#10b981; font-weight:800;"></p>
        <button class="btn" style="text-align:center; background: #f8fafc; color: #0f172a; font-weight: 800;" onclick="location.reload()">Start Over</button>
    </div>
</div>

<script>
const items = {
    "math": [
        { q: "Solve for x: 4x - 7 = 21", v: "‚öñÔ∏è", a: ["7", "6", "8", "5"], c: "7" },
        { q: "Area of a circle with radius 3? (œÄ=3.14)", v: "‚≠ï", a: ["28.26", "18.84", "9.42", "31.4"], c: "28.26" },
        { q: "What is 15% of 60?", v: "üî¢", a: ["9", "6", "12", "15"], c: "9" },
        { q: "Volume of a box 4x3x2?", v: "üì¶", a: ["24", "12", "18", "48"], c: "24" },
        { q: "Solve: 2(x + 5) = 22", v: "‚öñÔ∏è", a: ["6", "11", "12", "8"], c: "6" },
        { q: "What is the square root of 225?", v: "‚àö", a: ["15", "12", "25", "20"], c: "15" },
        { q: "Find the median: 3, 7, 9, 12, 15", v: "üìä", a: ["9", "7", "12", "10"], c: "9" },
        { q: "Value of 4 to the power of 3?", v: "üî¢", a: ["64", "16", "32", "12"], c: "64" },
        { q: "A triangle has base 10 and height 4. Area?", v: "üìê", a: ["20", "40", "14", "10"], c: "20" },
        { q: "Next in sequence: 2, 5, 10, 17...", v: "üî¢", a: ["26", "24", "25", "19"], c: "26" },
        { q: "Write 3/8 as a decimal.", v: "üî¢", a: ["0.375", "0.38", "0.4", "0.33"], c: "0.375" },
        { q: "Degrees in a quadrilateral?", v: "‚ñ≠", a: ["360", "180", "90", "270"], c: "360" },
        { q: "Solve for y: y/4 + 6 = 10", v: "‚öñÔ∏è", a: ["16", "8", "4", "20"], c: "16" },
        { q: "Slope of line through (0,0) and (2,4)?", v: "üìà", a: ["2", "1/2", "4", "0"], c: "2" },
        { q: "Simplest form of 42/56?", v: "üçï", a: ["3/4", "6/8", "1/2", "2/3"], c: "3/4" },
        { q: "Absolute value of |-12 + 5|?", v: "üî¢", a: ["7", "-7", "17", "0"], c: "7" },
        { q: "GCF of 24 and 36?", v: "üî¢", a: ["12", "6", "8", "4"], c: "12" },
        { q: "How many mm in 1.5 meters?", v: "üìè", a: ["1500", "150", "15", "15000"], c: "1500" },
        { q: "Convert 5/4 to a percentage.", v: "üî¢", a: ["125%", "80%", "120%", "25%"], c: "125%" },
        { q: "Find the range: 10, 2, 8, 15, 1", v: "üìä", a: ["14", "15", "10", "7"], c: "14" },
        { q: "Solve: 5 squared minus 3 cubed.", v: "üî¢", a: ["-2", "2", "3", "0"], c: "-2" },
        { q: "Complementary angle to 30¬∞?", v: "üìê", a: ["60¬∞", "150¬∞", "90¬∞", "30¬∞"], c: "60¬∞" },
        { q: "A circle's diameter is 10. Circumference? (œÄ=3.14)", v: "‚≠ï", a: ["31.4", "15.7", "62.8", "100"], c: "31.4" },
        { q: "Product of 1.2 and 0.5?", v: "üî¢", a: ["0.6", "6", "0.06", "1.7"], c: "0.6" },
        { q: "Prime factors of 12?", v: "üî¢", a: ["2, 2, 3", "2, 6", "3, 4", "12, 1"], c: "2, 2, 3" },
        { q: "Solve: 10 - (-5)", v: "‚öñÔ∏è", a: ["15", "5", "-5", "-15"], c: "15" },
        { q: "What is 1/3 of 1/4?", v: "üçï", a: ["1/12", "1/7", "2/7", "3/4"], c: "1/12" },
        { q: "Surface area of cube with side 3?", v: "üì¶", a: ["54", "27", "9", "36"], c: "54" },
        { q: "If x=2, what is 3x¬≤ + 4?", v: "‚öñÔ∏è", a: ["16", "40", "10", "22"], c: "16" },
        { q: "Sum of angles in a hexagon?", v: "‚¨°", a: ["720", "540", "360", "1080"], c: "720" },
        { q: "Solve for k: 5k - 2 = 13", v: "‚öñÔ∏è", a: ["3", "5", "4", "2"], c: "3" },
        { q: "A cube has volume 64. Side length?", v: "üì¶", a: ["4", "8", "16", "2"], c: "4" },
        { q: "How many degrees in half a circle?", v: "üìê", a: ["180", "90", "360", "270"], c: "180" },
        { q: "Probability of picking a King from a 52 deck?", v: "üÉè", a: ["1/13", "4/13", "1/52", "1/4"], c: "1/13" },
        { q: "Sum of prime numbers between 1 and 10?", v: "üî¢", a: ["17", "18", "15", "20"], c: "17" }
    ],
    "ela": [
        { q: "Meaning of 'Exhilarating'?", v: "üé¢", a: ["Thrilling", "Boring", "Tiring", "Scary"], c: "Thrilling" },
        { q: "Antonym for 'Fragile'?", v: "üíé", a: ["Sturdy", "Weak", "Broken", "Small"], c: "Sturdy" },
        { q: "Identify the Onomatopoeia:", v: "üí•", a: ["Sizzle", "Bright", "Quickly", "Walked"], c: "Sizzle" },
        { q: "Main character of a story is the...", v: "üé≠", a: ["Protagonist", "Antagonist", "Narrator", "Dynamic"], c: "Protagonist" },
        { q: "A 'Hyperbole' is a huge...", v: "üìà", a: ["Exaggeration", "Comparison", "Understatement", "Lie"], c: "Exaggeration" },
        { q: "Which is a 'Proper Noun'?", v: "üìç", a: ["Tokyo", "City", "Mountain", "River"], c: "Tokyo" },
        { q: "Word that describes a verb?", v: "‚ú®", a: ["Adverb", "Adjective", "Pronoun", "Noun"], c: "Adverb" },
        { q: "A comparison using 'is' (not like/as)?", v: "üìñ", a: ["Metaphor", "Simile", "Personification", "Idiom"], c: "Metaphor" },
        { q: "Which part of a plot resolves the conflict?", v: "üèÅ", a: ["Resolution", "Climax", "Exposition", "Rising Action"], c: "Resolution" },
        { q: "The 'central message' of a text?", v: "üí°", a: ["Theme", "Plot", "Setting", "Hook"], c: "Theme" },
        { q: "A story of one's own life written by oneself?", v: "‚úçÔ∏è", a: ["Autobiography", "Biography", "Fiction", "History"], c: "Autobiography" },
        { q: "A group of lines in a poem?", v: "üìú", a: ["Stanza", "Paragraph", "Chapter", "Verse"], c: "Stanza" },
        { q: "Meaning of the prefix 'Bio-'?", v: "üß¨", a: ["Life", "Earth", "Small", "Against"], c: "Life" },
        { q: "Opposite of 'Chaos'?", v: "‚öñÔ∏è", a: ["Order", "Mess", "Noise", "Wild"], c: "Order" },
        { q: "Punctuation to show strong emotion?", v: "‚ùó", a: ["Exclamation Point", "Period", "Comma", "Semicolon"], c: "Exclamation Point" },
        { q: "Words with same sounds but different meanings?", v: "üëØ", a: ["Homophones", "Synonyms", "Antonyms", "Nouns"], c: "Homophones" },
        { q: "Identify the conjunction:", v: "üîó", a: ["Because", "Jump", "Yellow", "He"], c: "Because" },
        { q: "Meaning of the suffix '-less'?", v: "‚ùå", a: ["Without", "Full of", "Able to", "Most"], c: "Without" },
        { q: "An 'Allusion' is a reference to...", v: "üèõÔ∏è", a: ["Another work/event", "A sound", "A character's name", "The future"], c: "Another work/event" },
        { q: "Identify the Adjective: 'The silent room.'", v: "ü§´", a: ["Silent", "The", "Room", "Is"], c: "Silent" },
        { q: "Past tense of 'Catch'?", v: "‚öæ", a: ["Caught", "Catched", "Catching", "Catchs"], c: "Caught" },
        { q: "A person against the protagonist?", v: "üòà", a: ["Antagonist", "Sidekick", "Hero", "Author"], c: "Antagonist" },
        { q: "Meaning of 'Benevolent'?", v: "üòá", a: ["Kind", "Cruel", "Rich", "Fast"], c: "Kind" },
        { q: "Short story meant to teach a lesson?", v: "ü¶ä", a: ["Fable", "Epic", "Novel", "Essay"], c: "Fable" },
        { q: "Giving human traits to objects?", v: "üß∏", a: ["Personification", "Simile", "Alliteration", "Irony"], c: "Personification" },
        { q: "Identify the Preposition:", v: "üó∫Ô∏è", a: ["Under", "Fast", "Apple", "They"], c: "Under" },
        { q: "Repetition of initial consonant sounds?", v: "üî°", a: ["Alliteration", "Rhyme", "Metaphor", "Rhythm"], c: "Alliteration" },
        { q: "Informal, specialized language of a group?", v: "üí¨", a: ["Jargon", "Dialect", "Prose", "Formal"], c: "Jargon" },
        { q: "An 'Oxymoron' is two words that...", v: "üåì", a: ["Contradict each other", "Rhyme", "Sound alike", "Are long"], c: "Contradict each other" },
        { q: "A 'clich√©' is an expression that is...", v: "üò¥", a: ["Overused", "Original", "Scientific", "Short"], c: "Overused" },
        { q: "Identify the pronoun: 'We will win.'", v: "üë§", a: ["We", "Will", "Win", "Them"], c: "We" },
        { q: "Synonym for 'Lethargic'?", v: "üò¥", a: ["Tired", "Excited", "Fast", "Angry"], c: "Tired" },
        { q: "A book's list of sources is called a...", v: "üìö", a: ["Bibliography", "Index", "Glossary", "Preface"], c: "Bibliography" },
        { q: "Which word is misspelled?", v: "‚úèÔ∏è", a: ["Recieve", "Believe", "Achieve", "Deceive"], c: "Recieve" },
        { q: "The 'Resolution' of a story comes...", v: "üèÅ", a: ["At the end", "At the start", "In the middle", "Never"], c: "At the end" }
    ],
    "science": [
        { q: "Smallest unit of an element?", v: "‚öõÔ∏è", a: ["Atom", "Molecule", "Cell", "Tissue"], c: "Atom" },
        { q: "Which state of matter has a fixed volume but no fixed shape?", v: "üíß", a: ["Liquid", "Solid", "Gas", "Plasma"], c: "Liquid" },
        { q: "Earth's center layer?", v: "üåç", a: ["Core", "Mantle", "Crust", "Atmosphere"], c: "Core" },
        { q: "Process by which plants make food?", v: "üåø", a: ["Photosynthesis", "Respiration", "Digestion", "Osmosis"], c: "Photosynthesis" },
        { q: "Force that resists motion between surfaces?", v: "üëû", a: ["Friction", "Gravity", "Magnetism", "Inertia"], c: "Friction" },
        { q: "Unit of electrical resistance?", v: "‚ö°", a: ["Ohm", "Volt", "Amp", "Watt"], c: "Ohm" },
        { q: "Which gas is most abundant in Earth's atmosphere?", v: "‚òÅÔ∏è", a: ["Nitrogen", "Oxygen", "Carbon Dioxide", "Argon"], c: "Nitrogen" },
        { q: "A circuit with only one path is a...", v: "üîå", a: ["Series circuit", "Parallel circuit", "Short circuit", "Open circuit"], c: "Series circuit" },
        { q: "Energy of motion is called...", v: "üèÉ", a: ["Kinetic", "Potential", "Thermal", "Chemical"], c: "Kinetic" },
        { q: "What is the pH of pure water?", v: "üß™", a: ["7", "0", "14", "1"], c: "7" },
        { q: "Blood cells that carry oxygen?", v: "ü©∏", a: ["Red cells", "White cells", "Platelets", "Plasma"], c: "Red cells" },
        { q: "Turning from gas directly to solid?", v: "‚ùÑÔ∏è", a: ["Deposition", "Sublimation", "Freezing", "Melting"], c: "Deposition" },
        { q: "The 'Brain' of the cell?", v: "üß¨", a: ["Nucleus", "Vacuole", "Ribosome", "Wall"], c: "Nucleus" },
        { q: "Speed with a direction is...", v: "üèéÔ∏è", a: ["Velocity", "Acceleration", "Momentum", "Inertia"], c: "Velocity" },
        { q: "Type of rock formed by heat and pressure?", v: "üíé", a: ["Metamorphic", "Igneous", "Sedimentary", "Magma"], c: "Metamorphic" },
        { q: "Largest organ of the human body?", v: "üë§", a: ["Skin", "Liver", "Lungs", "Brain"], c: "Skin" },
        { q: "Temperature where all motion stops?", v: "ü•∂", a: ["Absolute Zero", "0¬∞C", "0¬∞F", "Freezing"], c: "Absolute Zero" },
        { q: "Device used to measure air pressure?", v: "üå°Ô∏è", a: ["Barometer", "Anemometer", "Thermometer", "Hygrometer"], c: "Barometer" },
        { q: "Planets that lack solid surfaces?", v: "ü™ê", a: ["Gas Giants", "Terrestrial", "Dwarfs", "Moons"], c: "Gas Giants" },
        { q: "Human body's master gland?", v: "üß†", a: ["Pituitary", "Thyroid", "Adrenal", "Heart"], c: "Pituitary" },
        { q: "Substance that speeds up chemical reactions?", v: "üß™", a: ["Catalyst", "Isotope", "Solvent", "Acid"], c: "Catalyst" },
        { q: "Moon phase when it is invisible?", v: "üåë", a: ["New Moon", "Full Moon", "Gibbous", "Crescent"], c: "New Moon" },
        { q: "Animal without a backbone?", v: "üêõ", a: ["Invertebrate", "Mammal", "Reptile", "Bird"], c: "Invertebrate" },
        { q: "Study of weather?", v: "‚õàÔ∏è", a: ["Meteorology", "Geology", "Biology", "Astronomy"], c: "Meteorology" },
        { q: "Force that pulls objects toward Earth?", v: "üåç", a: ["Gravity", "Tension", "Lift", "Drag"], c: "Gravity" },
        { q: "Cloud type that looks like cotton balls?", v: "‚òÅÔ∏è", a: ["Cumulus", "Stratus", "Cirrus", "Nimbus"], c: "Cumulus" },
        { q: "Distance light travels in a year?", v: "‚ú®", a: ["Light Year", "Parsec", "Astronomical Unit", "Mach"], c: "Light Year" },
        { q: "Bond where atoms share electrons?", v: "ü§ù", a: ["Covalent", "Ionic", "Metallic", "Hydrogen"], c: "Covalent" },
        { q: "Earth's orbit shape?", v: "üîÑ", a: ["Elliptical", "Circular", "Square", "Wavy"], c: "Elliptical" },
        { q: "First element on the Periodic Table?", v: "üéà", a: ["Hydrogen", "Helium", "Lithium", "Oxygen"], c: "Hydrogen" },
        { q: "Energy stored in a spring is...", v: "üåÄ", a: ["Elastic Potential", "Thermal", "Kinetic", "Sound"], c: "Elastic Potential" },
        { q: "A push or pull is called a...", v: "üí•", a: ["Force", "Power", "Weight", "Work"], c: "Force" },
        { q: "Part of the plant that takes in water?", v: "üå±", a: ["Roots", "Leaves", "Stem", "Flower"], c: "Roots" },
        { q: "Hottest planet in the solar system?", v: "üî•", a: ["Venus", "Mercury", "Jupiter", "Mars"], c: "Venus" },
        { q: "Measure of the pull of gravity on mass?", v: "‚öñÔ∏è", a: ["Weight", "Density", "Volume", "Height"], c: "Weight" }
    ],
    "social": [
        { q: "Who was the 'Father of the Constitution'?", v: "üìú", a: ["James Madison", "Washington", "Jefferson", "Hamilton"], c: "James Madison" },
        { q: "In which year did the US Civil War begin?", v: "‚öîÔ∏è", a: ["1861", "1776", "1812", "1914"], c: "1861" },
        { q: "The first 10 Amendments are called...", v: "üìú", a: ["Bill of Rights", "Preamble", "Articles", "Federalist"], c: "Bill of Rights" },
        { q: "Ancient system of writing in Egypt?", v: "üìê", a: ["Hieroglyphics", "Cuneiform", "Latin", "Sanskrit"], c: "Hieroglyphics" },
        { q: "Smallest country in the world?", v: "üáªüá¶", a: ["Vatican City", "Monaco", "Iceland", "Malta"], c: "Vatican City" },
        { q: "Who was the main author of the Declaration?", v: "‚úçÔ∏è", a: ["Jefferson", "Franklin", "Adams", "Lincoln"], c: "Jefferson" },
        { q: "Which empire built the Colosseum?", v: "üèõÔ∏è", a: ["Roman", "Greek", "Ottoman", "Persian"], c: "Roman" },
        { q: "Capital of China?", v: "üá®üá≥", a: ["Beijing", "Shanghai", "Tokyo", "Seoul"], c: "Beijing" },
        { q: "War between the US and Great Britain (1800s)?", v: "üö¢", a: ["War of 1812", "Revolution", "WW1", "Civil War"], c: "War of 1812" },
        { q: "The imaginary line at 0¬∞ Longitude?", v: "üåç", a: ["Prime Meridian", "Equator", "Tropic", "Dateline"], c: "Prime Meridian" },
        { q: "Who gave the 'Gettysburg Address'?", v: "üé©", a: ["Lincoln", "Kennedy", "Roosevelt", "Obama"], c: "Lincoln" },
        { q: "Largest desert in the world?", v: "üèúÔ∏è", a: ["Antarctic", "Sahara", "Gobi", "Atacama"], c: "Antarctic" },
        { q: "Which explorer 'discovered' the Americas in 1492?", v: "‚õµ", a: ["Columbus", "Magellan", "Cook", "Vespucci"], c: "Columbus" },
        { q: "Economic system based on private ownership?", v: "üí∞", a: ["Capitalism", "Communism", "Socialism", "Bartering"], c: "Capitalism" },
        { q: "First person to sign the Declaration?", v: "‚úçÔ∏è", a: ["John Hancock", "Sam Adams", "Ben Franklin", "Washington"], c: "John Hancock" },
        { q: "Ancient civilization in the Andes Mountains?", v: "üèîÔ∏è", a: ["Inca", "Aztec", "Maya", "Olmec"], c: "Inca" },
        { q: "Which ocean is on the East Coast of the US?", v: "üåä", a: ["Atlantic", "Pacific", "Indian", "Arctic"], c: "Atlantic" },
        { q: "Leader of the Civil Rights Movement (Dream)?", v: "üéôÔ∏è", a: ["MLK Jr.", "Malcolm X", "John Lewis", "Thurgood"], c: "MLK Jr." },
        { q: "Current number of Amendments to the Constitution?", v: "üìú", a: ["27", "10", "50", "13"], c: "27" },
        { q: "Which country gifted the Statue of Liberty?", v: "üóΩ", a: ["France", "England", "Germany", "Canada"], c: "France" },
        { q: "The 'industrial revolution' began in which country?", v: "‚öôÔ∏è", a: ["Great Britain", "USA", "France", "Japan"], c: "Great Britain" },
        { q: "Longest river in the world?", v: "üõ∂", a: ["Nile", "Amazon", "Mississippi", "Yangtze"], c: "Nile" },
        { q: "Amendment that gave women the right to vote?", v: "üó≥Ô∏è", a: ["19th", "1st", "13th", "21st"], c: "19th" },
        { q: "Period of history 'rebirth' after Middle Ages?", v: "üé®", a: ["Renaissance", "Enlightenment", "Victorian", "Dark Ages"], c: "Renaissance" },
        { q: "What was the trail used to move Native Americans?", v: "üë£", a: ["Trail of Tears", "Oregon Trail", "Santa Fe", "Silk Road"], c: "Trail of Tears" },
        { q: "President during the Great Depression?", v: "üìâ", a: ["FDR", "Hoover", "Truman", "Wilson"], c: "FDR" },
        { q: "River that runs through Egypt?", v: "üá™üá¨", a: ["Nile", "Congo", "Jordan", "Euphrates"], c: "Nile" },
        { q: "Who 'won' the Space Race by landing on the moon?", v: "üöÄ", a: ["USA", "USSR", "China", "Germany"], c: "USA" },
        { q: "System where people vote for leaders?", v: "‚öñÔ∏è", a: ["Republic/Democracy", "Monarchy", "Dictatorship", "Theocracy"], c: "Republic/Democracy" },
        { q: "What event triggered World War I?", v: "üî´", a: ["Assassination of Archduke", "Pearl Harbor", "D-Day", "Atomic Bomb"], c: "Assassination of Archduke" },
        { q: "The 'Liberty Bell' is located in...", v: "üîî", a: ["Philadelphia", "DC", "Boston", "NYC"], c: "Philadelphia" },
        { q: "Who wrote 'Common Sense'?", v: "‚úçÔ∏è", a: ["Thomas Paine", "Franklin", "Jefferson", "Adams"], c: "Thomas Paine" },
        { q: "Country with the most population?", v: "üåç", a: ["India", "China", "USA", "Russia"], c: "India" },
        { q: "Main axis power in WW2?", v: "‚öîÔ∏è", a: ["Germany", "England", "Russia", "USA"], c: "Germany" },
        { q: "US Branch that makes laws?", v: "‚öñÔ∏è", a: ["Legislative", "Executive", "Judicial", "State"], c: "Legislative" }
    ]
};

const grades = ["GRADE 6", "GRADE 7", "GRADE 8"];
let state = { sub: "", idx: 0, rit: 215, seen: [], streak: 0, gradeIdx: 0, correct: 0 };

function run(s) {
    state = { sub: s, idx: 0, rit: 215, seen: [], streak: 0, gradeIdx: 0, correct: 0 };
    document.getElementById('home').classList.add('hidden');
    document.getElementById('quiz').classList.remove('hidden');
    document.getElementById('progress-fill').style.background = `var(--${s})`;
    render();
}

function render() {
    if (state.idx >= 30) return finish(); // Ends exactly at 30 items
    if (state.streak >= 3) { state.streak = 0; if (state.gradeIdx < 2) state.gradeIdx++; }

    let pool = items[state.sub].filter(q => !state.seen.includes(q.q));
    if (pool.length === 0) return finish(); 
    
    let q = pool[Math.floor(Math.random() * pool.length)];
    state.seen.push(q.q);
    
    document.getElementById('q-count').innerText = `ITEM ${state.idx + 1} / 30`;
    document.getElementById('grade-level').innerText = grades[state.gradeIdx];
    document.getElementById('progress-fill').style.width = `${(state.idx / 30) * 100}%`;
    document.getElementById('visual-area').innerText = q.v;
    document.getElementById('q-text').innerText = q.q;

    for(let i=1; i<=3; i++) { 
        document.getElementById(`d${i}`).className = i <= state.streak ? "dot active" : "dot"; 
    }

    let box = document.getElementById('options');
    box.innerHTML = "";
    [...q.a].sort(() => Math.random() - 0.5).forEach(opt => {
        let b = document.createElement('button');
        b.className = "btn";
        b.innerText = opt;
        b.onclick = () => {
            if(opt === q.c) { 
                state.rit += 4; state.streak++; state.correct++; 
            } else { 
                if (state.streak === 0 && state.gradeIdx > 0) state.gradeIdx--;
                state.rit = Math.max(160, state.rit - 3); 
                state.streak = 0; 
            }
            state.idx++; render();
        };
        box.appendChild(b);
    });
}

function finish() {
    document.getElementById('quiz').classList.add('hidden');
    document.getElementById('results').classList.remove('hidden');
    document.getElementById('final-rit').innerText = state.rit;
    document.getElementById('accuracy').innerText = `Final Result: ${state.correct} / 30`;
}
</script>
</body>
</html>